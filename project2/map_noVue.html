<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
	<style type="text/css">
		body, html{width: 100%;height: 100%;margin:0;font-family:"微软雅黑";}
		#r-result{width:100%; font-size:14px;}
	</style>
	<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=Cq1UWYjYILQkz99rehq2Rsq7pkIxPDib"></script>
	<title>Aecie Map of Info</title>
</head>
<body>
	<div id="ac_map" style = "border:#ccc solid 5px; position: absolute; right: 0%; top: 0%; bottom: 0%; width: 80%;"></div>
	
	<div style = "background-color: rgb(66, 133, 244); position: absolute; top: 0; left: 0; bottom: 0%; right: 80%;">
		<div style = "color: white; text-align: center; font-size: 30px; position: relative; top: 5%;"> Aecie Map of Info </div>
		
		<div style = "background-color: rgb(51, 103, 214); position: relative; width: 80%; height: 5%; margin: auto; border-radius: 5px; top: 10%;">
			
			<div style = "color: white; position: relative; left: 5%; line-height:50px;">
				Search: 
				<input id="cityName" type="text" value = "where to go" style="width:190px; color: white; font-size: 17px;
				border-bottom: white 1px solid; border-top-style: none; border-right-style: none; border-left-style: none;
				background-color: transparent;" />
				
				<img src = "image/search.png" width = "20" height = "20" onclick = "theLocation()" style = "cursor: pointer;" />
			</div>
		</div>
	
	</div>





</body>
</html>
<script type="text/javascript">
	// 百度地图API功能
	function init(){
		createMap();
		setMapEvent();
		searchPoint();
	}
		
	function createMap(){
		var map = new BMap.Map("ac_map");
		var point = new BMap.Point(116.331398,39.897445);
		map.centerAndZoom(point,5);
		window.map = map;
	}

	function setMapEvent(){
		map.enableDragging();
	//	map.enableScrollWheelZoom();
	//	map.enableDoubleClickZoom();
		map.enableKeyboard();	
	}
	
	

	function theLocation(){
		var city = document.getElementById("cityName").value;
		if(city != ""){
			map.centerAndZoom(city,20);      // 用城市名设置地图中心点
		}
	}

	function searchPoint(){
		var citys = new Array("北京", "上海", "重庆", "天津", "哈尔滨", "长春", "沈阳", "呼和浩特", "石家庄", "郑州", "济南", "太原", "南京", "合肥", "西安", "银川", "兰州", "西宁", "武汉", "长沙", "杭州", "南昌", "福州", "贵阳", "成都", "广州", "南宁", "昆明", "海口", "乌鲁木齐", "拉萨", "台北", "香港", "澳门");
		for(x in citys){
			getWeatherByName(citys[x]);
		}
	}

	function getWeatherByName(cityName){
		var xmlHttp = false;
		try{
			xmlHttp = new ActiveXObject("Msm12.XMLHTTP");
		} catch(e){
			try{
				xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
			}catch(E){
				xmlHttp = false;
			}
		}

		if (!xmlHttp && typeof XMLHttpRequest != "undefined"){
			xmlHttp = new XMLHttpRequest();
		}

		var serverPage = "weather/weather.php?a=" + cityName + "&tmp" +Math.random();
		xmlHttp.open("GET", encodeURI(serverPage));
		xmlHttp.onreadystatechange = function(){
			if(xmlHttp.readyState == 4 && xmlHttp.status == 200){
				searchPointByName(cityName, xmlHttp.responseText);
			}
		}
		xmlHttp.send(null);
	}

	function searchPointByName(cityName, content){
		var options = {
			onSearchComplete: function(results){
				if(local.getStatus() == BMAP_STATUS_SUCCESS){
					var markerPoint = results.getPoi(0).point;
					var marker = new BMap.Marker(markerPoint);
					map.addOverlay(marker);
					var opts = {
						width: 400,
						height: 160,
						title: cityName
					}
					var infoWindow = new BMap.InfoWindow(content, opts);

					marker.addEventListener("click", function(){
						this.openInfoWindow(infoWindow);
					});
				}
			}
		};

		var local = new BMap.LocalSearch(map, options);
		local.enableFirstResultSelection();
		local.search(cityName);
	}

	init();
</script>